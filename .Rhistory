scaled.model$dprime %>% head
scaled.model <- model.wide %>%
rowwise() %>%
mutate(n_obs = length(data_response_vec_0[,1]),
SUBJECT = "model",
var_scale = list((1 + scale.val) * (data_var_vec_0 + data_var_vec_1)),
data_cor_vec_0 = list(c(data_cov_vec_0 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_cor_vec_1 = list(c(data_cov_vec_1 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_var_vec_0 = list(data_var_vec_0 + var_scale),
data_var_vec_1 = list(data_var_vec_1 + var_scale),
data_sd_vec_1 = list(sqrt(data_var_vec_1)),
data_sd_vec_0 = list(sqrt(data_var_vec_0)),
data_cor_mat_0 = list(matrix(c(1, data_cor_vec_0[1], data_cor_vec_0[2],data_cor_vec_0[1],1,data_cor_vec_0[3],data_cor_vec_0[2],data_cor_vec_0[3],1),nrow = 3)),
data_cor_mat_1 = list(matrix(c(1, data_cor_vec_1[1], data_cor_vec_1[2],data_cor_vec_1[1],1,data_cor_vec_1[3],data_cor_vec_1[2],data_cor_vec_1[3],1),nrow = 3)),
data_cov_mat_0 = list(data_cor_mat_0 * (data_sd_vec_0) %*% t(data_sd_vec_0)),
data_cov_mat_1 = list(data_cor_mat_1 * (data_sd_vec_1) %*% t(data_sd_vec_1)),
data_response_vec_0 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_0, sigma = data_cov_mat_0)),
data_response_vec_1 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_1, sigma = data_cov_mat_1)),
log_lik_absent      = list((mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
log_lik_present     = list((mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
pc = (sum(log_lik_present > 0) + (sum(log_lik_absent < 0)))/(2 * 1000) - 1/1000,
cr = integrate(f1, -Inf, 0, mu=mean(log_lik_present), sd=sd(log_lik_present))$value,
hit = integrate(f1, 0, Inf, mu=mean(log_lik_present),  sd=sd(log_lik_absent))$value,
pc = hit + cr,
dprime = 2 * qnorm(pc + 1/2^50)
)
scaled.model$dprime %>% head
scaled.model$pc %>% head
scaled.model <- model.wide %>%
rowwise() %>%
mutate(n_obs = length(data_response_vec_0[,1]),
SUBJECT = "model",
var_scale = list((1 + scale.val) * (data_var_vec_0 + data_var_vec_1)),
data_cor_vec_0 = list(c(data_cov_vec_0 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_cor_vec_1 = list(c(data_cov_vec_1 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_var_vec_0 = list(data_var_vec_0 + var_scale),
data_var_vec_1 = list(data_var_vec_1 + var_scale),
data_sd_vec_1 = list(sqrt(data_var_vec_1)),
data_sd_vec_0 = list(sqrt(data_var_vec_0)),
data_cor_mat_0 = list(matrix(c(1, data_cor_vec_0[1], data_cor_vec_0[2],data_cor_vec_0[1],1,data_cor_vec_0[3],data_cor_vec_0[2],data_cor_vec_0[3],1),nrow = 3)),
data_cor_mat_1 = list(matrix(c(1, data_cor_vec_1[1], data_cor_vec_1[2],data_cor_vec_1[1],1,data_cor_vec_1[3],data_cor_vec_1[2],data_cor_vec_1[3],1),nrow = 3)),
data_cov_mat_0 = list(data_cor_mat_0 * (data_sd_vec_0) %*% t(data_sd_vec_0)),
data_cov_mat_1 = list(data_cor_mat_1 * (data_sd_vec_1) %*% t(data_sd_vec_1)),
data_response_vec_0 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_0, sigma = data_cov_mat_0)),
data_response_vec_1 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_1, sigma = data_cov_mat_1)),
log_lik_absent      = list((mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
log_lik_present     = list((mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
pc = (sum(log_lik_present > 0) + (sum(log_lik_absent < 0)))/(2 * 1000) - 1/1000,
cr = integrate(f1, -Inf, 0, mu=mean(log_lik_present), sd=sd(log_lik_present))$value,
hit = integrate(f1, 0, Inf, mu=mean(log_lik_absent),  sd=sd(log_lik_absent))$value,
pc = hit + cr,
dprime = 2 * qnorm(pc + 1/2^50)
)
scaled.model$pc %>% head
scaled.model <- model.wide %>%
rowwise() %>%
mutate(n_obs = length(data_response_vec_0[,1]),
SUBJECT = "model",
var_scale = list((1 + scale.val) * (data_var_vec_0 + data_var_vec_1)),
data_cor_vec_0 = list(c(data_cov_vec_0 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_cor_vec_1 = list(c(data_cov_vec_1 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_var_vec_0 = list(data_var_vec_0 + var_scale),
data_var_vec_1 = list(data_var_vec_1 + var_scale),
data_sd_vec_1 = list(sqrt(data_var_vec_1)),
data_sd_vec_0 = list(sqrt(data_var_vec_0)),
data_cor_mat_0 = list(matrix(c(1, data_cor_vec_0[1], data_cor_vec_0[2],data_cor_vec_0[1],1,data_cor_vec_0[3],data_cor_vec_0[2],data_cor_vec_0[3],1),nrow = 3)),
data_cor_mat_1 = list(matrix(c(1, data_cor_vec_1[1], data_cor_vec_1[2],data_cor_vec_1[1],1,data_cor_vec_1[3],data_cor_vec_1[2],data_cor_vec_1[3],1),nrow = 3)),
data_cov_mat_0 = list(data_cor_mat_0 * (data_sd_vec_0) %*% t(data_sd_vec_0)),
data_cov_mat_1 = list(data_cor_mat_1 * (data_sd_vec_1) %*% t(data_sd_vec_1)),
data_response_vec_0 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_0, sigma = data_cov_mat_0)),
data_response_vec_1 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_1, sigma = data_cov_mat_1)),
log_lik_absent      = list((mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
log_lik_present     = list((mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
pc = (sum(log_lik_present > 0) + (sum(log_lik_absent < 0)))/(2 * 1000) - 1/1000,
cr = integrate(f1, -Inf, 0, mu=mean(log_lik_absent), sd=sd(log_lik_absent))$value,
cr = integrate(f1, 0, Inf, mu=mean(log_lik_present),  sd=sd(log_lik_present))$value,
pc = hit + cr,
dprime = 2 * qnorm(pc + 1/2^50)
)
scaled.model <- model.wide %>%
rowwise() %>%
mutate(n_obs = length(data_response_vec_0[,1]),
SUBJECT = "model",
var_scale = list((1 + scale.val) * (data_var_vec_0 + data_var_vec_1)),
data_cor_vec_0 = list(c(data_cov_vec_0 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_cor_vec_1 = list(c(data_cov_vec_1 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_var_vec_0 = list(data_var_vec_0 + var_scale),
data_var_vec_1 = list(data_var_vec_1 + var_scale),
data_sd_vec_1 = list(sqrt(data_var_vec_1)),
data_sd_vec_0 = list(sqrt(data_var_vec_0)),
data_cor_mat_0 = list(matrix(c(1, data_cor_vec_0[1], data_cor_vec_0[2],data_cor_vec_0[1],1,data_cor_vec_0[3],data_cor_vec_0[2],data_cor_vec_0[3],1),nrow = 3)),
data_cor_mat_1 = list(matrix(c(1, data_cor_vec_1[1], data_cor_vec_1[2],data_cor_vec_1[1],1,data_cor_vec_1[3],data_cor_vec_1[2],data_cor_vec_1[3],1),nrow = 3)),
data_cov_mat_0 = list(data_cor_mat_0 * (data_sd_vec_0) %*% t(data_sd_vec_0)),
data_cov_mat_1 = list(data_cor_mat_1 * (data_sd_vec_1) %*% t(data_sd_vec_1)),
data_response_vec_0 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_0, sigma = data_cov_mat_0)),
data_response_vec_1 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_1, sigma = data_cov_mat_1)),
log_lik_absent      = list((mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
log_lik_present     = list((mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
pc = (sum(log_lik_present > 0) + (sum(log_lik_absent < 0)))/(2 * 1000) - 1/1000,
cr = integrate(f1, -Inf, 0, mu=mean(log_lik_absent), sd=sd(log_lik_absent))$value,
hit = integrate(f1, 0, Inf, mu=mean(log_lik_present),  sd=sd(log_lik_present))$value,
pc = hit + cr,
dprime = 2 * qnorm(pc + 1/2^50)
)
scaled.model$pc %>% head
scaled.model <- model.wide %>%
rowwise() %>%
mutate(n_obs = length(data_response_vec_0[,1]),
SUBJECT = "model",
var_scale = list((1 + scale.val) * (data_var_vec_0 + data_var_vec_1)),
data_cor_vec_0 = list(c(data_cov_vec_0 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_cor_vec_1 = list(c(data_cov_vec_1 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_var_vec_0 = list(data_var_vec_0 + var_scale),
data_var_vec_1 = list(data_var_vec_1 + var_scale),
data_sd_vec_1 = list(sqrt(data_var_vec_1)),
data_sd_vec_0 = list(sqrt(data_var_vec_0)),
data_cor_mat_0 = list(matrix(c(1, data_cor_vec_0[1], data_cor_vec_0[2],data_cor_vec_0[1],1,data_cor_vec_0[3],data_cor_vec_0[2],data_cor_vec_0[3],1),nrow = 3)),
data_cor_mat_1 = list(matrix(c(1, data_cor_vec_1[1], data_cor_vec_1[2],data_cor_vec_1[1],1,data_cor_vec_1[3],data_cor_vec_1[2],data_cor_vec_1[3],1),nrow = 3)),
data_cov_mat_0 = list(data_cor_mat_0 * (data_sd_vec_0) %*% t(data_sd_vec_0)),
data_cov_mat_1 = list(data_cor_mat_1 * (data_sd_vec_1) %*% t(data_sd_vec_1)),
data_response_vec_0 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_0, sigma = data_cov_mat_0)),
data_response_vec_1 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_1, sigma = data_cov_mat_1)),
log_lik_absent      = list((mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
log_lik_present     = list((mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
pc = (sum(log_lik_present > 0) + (sum(log_lik_absent < 0)))/(2 * 1000) - 1/1000,
cr = integrate(f1, -Inf, 0, mu=mean(log_lik_absent), sd=sd(log_lik_absent))$value,
hit = integrate(f1, 0, Inf, mu=mean(log_lik_present),  sd=sd(log_lik_present))$value,
pc = (hit + cr)/2,
dprime = 2 * qnorm(pc + 1/2^50)
)
scaled.model$pc %>% head
scaled.model$dprime %>% head
qnorm(0.558970458530569 + 1/2^50)
scaled.model <- model.wide %>%
rowwise() %>%
mutate(n_obs = length(data_response_vec_0[,1]),
SUBJECT = "model",
var_scale = list((1 + scale.val) * (data_var_vec_0 + data_var_vec_1)),
data_cor_vec_0 = list(c(data_cov_vec_0 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_cor_vec_1 = list(c(data_cov_vec_1 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_var_vec_0 = list(data_var_vec_0 + var_scale),
data_var_vec_1 = list(data_var_vec_1 + var_scale),
data_sd_vec_1 = list(sqrt(data_var_vec_1)),
data_sd_vec_0 = list(sqrt(data_var_vec_0)),
data_cor_mat_0 = list(matrix(c(1, data_cor_vec_0[1], data_cor_vec_0[2],data_cor_vec_0[1],1,data_cor_vec_0[3],data_cor_vec_0[2],data_cor_vec_0[3],1),nrow = 3)),
data_cor_mat_1 = list(matrix(c(1, data_cor_vec_1[1], data_cor_vec_1[2],data_cor_vec_1[1],1,data_cor_vec_1[3],data_cor_vec_1[2],data_cor_vec_1[3],1),nrow = 3)),
data_cov_mat_0 = list(data_cor_mat_0 * (data_sd_vec_0) %*% t(data_sd_vec_0)),
data_cov_mat_1 = list(data_cor_mat_1 * (data_sd_vec_1) %*% t(data_sd_vec_1)),
data_response_vec_0 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_0, sigma = data_cov_mat_0)),
data_response_vec_1 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_1, sigma = data_cov_mat_1)),
log_lik_absent      = list((mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
log_lik_present     = list((mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
pc = (sum(log_lik_present > 0) + (sum(log_lik_absent < 0)))/(2 * 1000) - 1/1000,
cr = integrate(f1, -Inf, 0, mu=mean(log_lik_absent), sd=sd(log_lik_absent))$value,
hit = integrate(f1, 0, Inf, mu=mean(log_lik_present),  sd=sd(log_lik_present))$value,
pc = (hit + cr)/2,
dprime = 2 * qnorm(pc - 1/2^50)
)
scaled.model <- model.wide %>%
rowwise() %>%
mutate(n_obs = length(data_response_vec_0[,1]),
SUBJECT = "model",
var_scale = list((1 + scale.val) * (data_var_vec_0 + data_var_vec_1)),
data_cor_vec_0 = list(c(data_cov_vec_0 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_cor_vec_1 = list(c(data_cov_vec_1 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_var_vec_0 = list(data_var_vec_0 + var_scale),
data_var_vec_1 = list(data_var_vec_1 + var_scale),
data_sd_vec_1 = list(sqrt(data_var_vec_1)),
data_sd_vec_0 = list(sqrt(data_var_vec_0)),
data_cor_mat_0 = list(matrix(c(1, data_cor_vec_0[1], data_cor_vec_0[2],data_cor_vec_0[1],1,data_cor_vec_0[3],data_cor_vec_0[2],data_cor_vec_0[3],1),nrow = 3)),
data_cor_mat_1 = list(matrix(c(1, data_cor_vec_1[1], data_cor_vec_1[2],data_cor_vec_1[1],1,data_cor_vec_1[3],data_cor_vec_1[2],data_cor_vec_1[3],1),nrow = 3)),
data_cov_mat_0 = list(data_cor_mat_0 * (data_sd_vec_0) %*% t(data_sd_vec_0)),
data_cov_mat_1 = list(data_cor_mat_1 * (data_sd_vec_1) %*% t(data_sd_vec_1)),
data_response_vec_0 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_0, sigma = data_cov_mat_0)),
data_response_vec_1 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_1, sigma = data_cov_mat_1)),
log_lik_absent      = list((mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
log_lik_present     = list((mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
pc = (sum(log_lik_present > 0) + (sum(log_lik_absent < 0)))/(2 * 1000) - 1/1000,
cr = integrate(f1, -Inf, 0, mu=mean(log_lik_absent), sd=sd(log_lik_absent))$value,
hit = integrate(f1, 0, Inf, mu=mean(log_lik_present),  sd=sd(log_lik_present))$value,
pc = (hit + cr)/2,
dprime = 2 * qnorm(pc)
)
scale.val
scaled.model <- model.wide %>%
rowwise() %>%
mutate(n_obs = length(data_response_vec_0[,1]),
SUBJECT = "model",
var_scale = list((1 + scale.val) * (data_var_vec_0 + data_var_vec_1)),
data_cor_vec_0 = list(c(data_cov_vec_0 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_cor_vec_1 = list(c(data_cov_vec_1 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_var_vec_0 = list(data_var_vec_0 + var_scale),
data_var_vec_1 = list(data_var_vec_1 + var_scale),
data_sd_vec_1 = list(sqrt(data_var_vec_1)),
data_sd_vec_0 = list(sqrt(data_var_vec_0)),
data_cor_mat_0 = list(matrix(c(1, data_cor_vec_0[1], data_cor_vec_0[2],data_cor_vec_0[1],1,data_cor_vec_0[3],data_cor_vec_0[2],data_cor_vec_0[3],1),nrow = 3)),
data_cor_mat_1 = list(matrix(c(1, data_cor_vec_1[1], data_cor_vec_1[2],data_cor_vec_1[1],1,data_cor_vec_1[3],data_cor_vec_1[2],data_cor_vec_1[3],1),nrow = 3)),
data_cov_mat_0 = list(data_cor_mat_0 * (data_sd_vec_0) %*% t(data_sd_vec_0)),
data_cov_mat_1 = list(data_cor_mat_1 * (data_sd_vec_1) %*% t(data_sd_vec_1)),
data_response_vec_0 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_0, sigma = data_cov_mat_0)),
data_response_vec_1 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_1, sigma = data_cov_mat_1)),
log_lik_absent      = list((mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
log_lik_present     = list((mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
pc = (sum(log_lik_present > 0) + (sum(log_lik_absent < 0)))/(2 * 1000) - 1/1000,
cr = integrate(f1, -Inf, 0, mu=mean(log_lik_absent), sd=sd(log_lik_absent))$value,
hit = integrate(f1, 0, Inf, mu=mean(log_lik_present),  sd=sd(log_lik_present))$value,
pc = (hit + cr)/2,
pc = ifelse(pc == 0, 1/2^50, pc - 1/2^50),
dprime = 2 * qnorm(pc)
)
get_scaled_model <- function(model.wide, scale.val = 1) {
f1 <- function(x, mu, sd) {
f1 <- dnorm(x, mean=mu, sd=sd)
return(f1)
}
scaled.model <- model.wide %>%
rowwise() %>%
mutate(n_obs = length(data_response_vec_0[,1]),
SUBJECT = "model",
var_scale = list((1 + scale.val) * (data_var_vec_0 + data_var_vec_1)),
data_cor_vec_0 = list(c(data_cov_vec_0 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_cor_vec_1 = list(c(data_cov_vec_1 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_var_vec_0 = list(data_var_vec_0 + var_scale),
data_var_vec_1 = list(data_var_vec_1 + var_scale),
data_sd_vec_1 = list(sqrt(data_var_vec_1)),
data_sd_vec_0 = list(sqrt(data_var_vec_0)),
data_cor_mat_0 = list(matrix(c(1, data_cor_vec_0[1], data_cor_vec_0[2],data_cor_vec_0[1],1,data_cor_vec_0[3],data_cor_vec_0[2],data_cor_vec_0[3],1),nrow = 3)),
data_cor_mat_1 = list(matrix(c(1, data_cor_vec_1[1], data_cor_vec_1[2],data_cor_vec_1[1],1,data_cor_vec_1[3],data_cor_vec_1[2],data_cor_vec_1[3],1),nrow = 3)),
data_cov_mat_0 = list(data_cor_mat_0 * (data_sd_vec_0) %*% t(data_sd_vec_0)),
data_cov_mat_1 = list(data_cor_mat_1 * (data_sd_vec_1) %*% t(data_sd_vec_1)),
data_response_vec_0 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_0, sigma = data_cov_mat_0)),
data_response_vec_1 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_1, sigma = data_cov_mat_1)),
log_lik_absent      = list((mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
log_lik_present     = list((mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
pc = (sum(log_lik_present > 0) + (sum(log_lik_absent < 0)))/(2 * 1000) - 1/1000,
cr = integrate(f1, -Inf, 0, mu=mean(log_lik_absent), sd=sd(log_lik_absent))$value,
hit = integrate(f1, 0, Inf, mu=mean(log_lik_present),  sd=sd(log_lik_present))$value,
pc = (hit + cr)/2,
pc = ifelse(pc == 0, 1/2^50, pc - 1/2^50),
dprime = 2 * qnorm(pc)
)
}
scaled.model <- model.wide %>%
rowwise() %>%
mutate(n_obs = length(data_response_vec_0[,1]),
SUBJECT = "model",
var_scale = list((1 + scale.val) * (data_var_vec_0 + data_var_vec_1)),
data_cor_vec_0 = list(c(data_cov_vec_0 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_cor_vec_1 = list(c(data_cov_vec_1 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_var_vec_0 = list(data_var_vec_0 + var_scale),
data_var_vec_1 = list(data_var_vec_1 + var_scale),
data_sd_vec_1 = list(sqrt(data_var_vec_1)),
data_sd_vec_0 = list(sqrt(data_var_vec_0)),
data_cor_mat_0 = list(matrix(c(1, data_cor_vec_0[1], data_cor_vec_0[2],data_cor_vec_0[1],1,data_cor_vec_0[3],data_cor_vec_0[2],data_cor_vec_0[3],1),nrow = 3)),
data_cor_mat_1 = list(matrix(c(1, data_cor_vec_1[1], data_cor_vec_1[2],data_cor_vec_1[1],1,data_cor_vec_1[3],data_cor_vec_1[2],data_cor_vec_1[3],1),nrow = 3)),
data_cov_mat_0 = list(data_cor_mat_0 * (data_sd_vec_0) %*% t(data_sd_vec_0)),
data_cov_mat_1 = list(data_cor_mat_1 * (data_sd_vec_1) %*% t(data_sd_vec_1)),
data_response_vec_0 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_0, sigma = data_cov_mat_0)),
data_response_vec_1 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_1, sigma = data_cov_mat_1)),
log_lik_absent      = list((mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
log_lik_present     = list((mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
pc = (sum(log_lik_present > 0) + (sum(log_lik_absent < 0)))/(2 * 1000) - 1/1000,
cr = integrate(f1, -Inf, 0, mu=mean(log_lik_absent), sd=sd(log_lik_absent))$value,
hit = integrate(f1, 0, Inf, mu=mean(log_lik_present),  sd=sd(log_lik_present))$value,
pc = (hit + cr)/2,
pc = ifelse(pc == 0, 1/2^50, pc - 1/2^50),
dprime = 2 * qnorm(pc)
)
scaled.model <- model.wide %>%
rowwise() %>%
mutate(n_obs = length(data_response_vec_0[,1]),
SUBJECT = "model",
var_scale = list((1 + scale.val) * (data_var_vec_0 + data_var_vec_1)),
data_cor_vec_0 = list(c(data_cov_vec_0 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_cor_vec_1 = list(c(data_cov_vec_1 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_var_vec_0 = list(data_var_vec_0 + var_scale),
data_var_vec_1 = list(data_var_vec_1 + var_scale),
data_sd_vec_1 = list(sqrt(data_var_vec_1)),
data_sd_vec_0 = list(sqrt(data_var_vec_0)),
data_cor_mat_0 = list(matrix(c(1, data_cor_vec_0[1], data_cor_vec_0[2],data_cor_vec_0[1],1,data_cor_vec_0[3],data_cor_vec_0[2],data_cor_vec_0[3],1),nrow = 3)),
data_cor_mat_1 = list(matrix(c(1, data_cor_vec_1[1], data_cor_vec_1[2],data_cor_vec_1[1],1,data_cor_vec_1[3],data_cor_vec_1[2],data_cor_vec_1[3],1),nrow = 3)),
data_cov_mat_0 = list(data_cor_mat_0 * (data_sd_vec_0) %*% t(data_sd_vec_0)),
data_cov_mat_1 = list(data_cor_mat_1 * (data_sd_vec_1) %*% t(data_sd_vec_1)),
data_response_vec_0 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_0, sigma = data_cov_mat_0)),
data_response_vec_1 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_1, sigma = data_cov_mat_1)),
log_lik_absent      = list((mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
log_lik_present     = list((mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
pc = (sum(log_lik_present > 0) + (sum(log_lik_absent < 0)))/(2 * 1000) - 1/1000,
cr = integrate(f1, -Inf, 0, mu=mean(log_lik_absent), sd=sd(log_lik_absent))$value,
hit = integrate(f1, 0, Inf, mu=mean(log_lik_present),  sd=sd(log_lik_present))$value,
pc = (hit + cr)/2,
pc = ifelse(pc == 0, 1/2^50, pc - 1/2^50),
dprime = 2 * qnorm(pc)
)
scaled.model$cr
scaled.model$hit
scaled.model$pc
scaled.model <- model.wide %>%
rowwise() %>%
mutate(n_obs = length(data_response_vec_0[,1]),
SUBJECT = "model",
var_scale = list((1 + scale.val) * (data_var_vec_0 + data_var_vec_1)),
data_cor_vec_0 = list(c(data_cov_vec_0 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_cor_vec_1 = list(c(data_cov_vec_1 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_var_vec_0 = list(data_var_vec_0 + var_scale),
data_var_vec_1 = list(data_var_vec_1 + var_scale),
data_sd_vec_1 = list(sqrt(data_var_vec_1)),
data_sd_vec_0 = list(sqrt(data_var_vec_0)),
data_cor_mat_0 = list(matrix(c(1, data_cor_vec_0[1], data_cor_vec_0[2],data_cor_vec_0[1],1,data_cor_vec_0[3],data_cor_vec_0[2],data_cor_vec_0[3],1),nrow = 3)),
data_cor_mat_1 = list(matrix(c(1, data_cor_vec_1[1], data_cor_vec_1[2],data_cor_vec_1[1],1,data_cor_vec_1[3],data_cor_vec_1[2],data_cor_vec_1[3],1),nrow = 3)),
data_cov_mat_0 = list(data_cor_mat_0 * (data_sd_vec_0) %*% t(data_sd_vec_0)),
data_cov_mat_1 = list(data_cor_mat_1 * (data_sd_vec_1) %*% t(data_sd_vec_1)),
data_response_vec_0 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_0, sigma = data_cov_mat_0)),
data_response_vec_1 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_1, sigma = data_cov_mat_1)),
log_lik_absent      = list((mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
log_lik_present     = list((mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
pc = (sum(log_lik_present > 0) + (sum(log_lik_absent < 0)))/(2 * 1000) - 1/1000,
cr = integrate(f1, -Inf, 0, mu=mean(log_lik_absent), sd=sd(log_lik_absent))$value,
hit = integrate(f1, 0, Inf, mu=mean(log_lik_present),  sd=sd(log_lik_present))$value,
pc = (hit + cr)/2,
pc = ifelse(pc == 0, 1/2^50, pc - 1/2^50),
dprime = 2 * qnorm(.5)
)
scaled.model <- model.wide %>%
rowwise() %>%
mutate(n_obs = length(data_response_vec_0[,1]),
SUBJECT = "model",
var_scale = list((1 + scale.val) * (data_var_vec_0 + data_var_vec_1)),
data_cor_vec_0 = list(c(data_cov_vec_0 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_cor_vec_1 = list(c(data_cov_vec_1 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_var_vec_0 = list(data_var_vec_0 + var_scale),
data_var_vec_1 = list(data_var_vec_1 + var_scale),
data_sd_vec_1 = list(sqrt(data_var_vec_1)),
data_sd_vec_0 = list(sqrt(data_var_vec_0)),
data_cor_mat_0 = list(matrix(c(1, data_cor_vec_0[1], data_cor_vec_0[2],data_cor_vec_0[1],1,data_cor_vec_0[3],data_cor_vec_0[2],data_cor_vec_0[3],1),nrow = 3)),
data_cor_mat_1 = list(matrix(c(1, data_cor_vec_1[1], data_cor_vec_1[2],data_cor_vec_1[1],1,data_cor_vec_1[3],data_cor_vec_1[2],data_cor_vec_1[3],1),nrow = 3)),
data_cov_mat_0 = list(data_cor_mat_0 * (data_sd_vec_0) %*% t(data_sd_vec_0)),
data_cov_mat_1 = list(data_cor_mat_1 * (data_sd_vec_1) %*% t(data_sd_vec_1)),
data_response_vec_0 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_0, sigma = data_cov_mat_0)),
data_response_vec_1 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_1, sigma = data_cov_mat_1)),
log_lik_absent      = list((mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
log_lik_present     = list((mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
pc = (sum(log_lik_present > 0) + (sum(log_lik_absent < 0)))/(2 * 1000) - 1/1000,
cr = integrate(f1, -Inf, 0, mu=mean(log_lik_absent), sd=sd(log_lik_absent))$value,
hit = integrate(f1, 0, Inf, mu=mean(log_lik_present),  sd=sd(log_lik_present))$value,
pc = round((hit + cr)/2,5),
pc = ifelse(pc == 0, 1/2^50, pc - 1/2^50),
dprime = 2 * qnorm(.5)
)
scaled.model <- model.wide %>%
rowwise() %>%
mutate(n_obs = length(data_response_vec_0[,1]),
SUBJECT = "model",
var_scale = list((1 + scale.val) * (data_var_vec_0 + data_var_vec_1)),
data_cor_vec_0 = list(c(data_cov_vec_0 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_cor_vec_1 = list(c(data_cov_vec_1 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_var_vec_0 = list(data_var_vec_0 + var_scale),
data_var_vec_1 = list(data_var_vec_1 + var_scale),
data_sd_vec_1 = list(sqrt(data_var_vec_1)),
data_sd_vec_0 = list(sqrt(data_var_vec_0)),
data_cor_mat_0 = list(matrix(c(1, data_cor_vec_0[1], data_cor_vec_0[2],data_cor_vec_0[1],1,data_cor_vec_0[3],data_cor_vec_0[2],data_cor_vec_0[3],1),nrow = 3)),
data_cor_mat_1 = list(matrix(c(1, data_cor_vec_1[1], data_cor_vec_1[2],data_cor_vec_1[1],1,data_cor_vec_1[3],data_cor_vec_1[2],data_cor_vec_1[3],1),nrow = 3)),
data_cov_mat_0 = list(data_cor_mat_0 * (data_sd_vec_0) %*% t(data_sd_vec_0)),
data_cov_mat_1 = list(data_cor_mat_1 * (data_sd_vec_1) %*% t(data_sd_vec_1)),
data_response_vec_0 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_0, sigma = data_cov_mat_0)),
data_response_vec_1 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_1, sigma = data_cov_mat_1)),
log_lik_absent      = list((mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
log_lik_present     = list((mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
pc = (sum(log_lik_present > 0) + (sum(log_lik_absent < 0)))/(2 * 1000) - 1/1000,
cr = integrate(f1, -Inf, 0, mu=mean(log_lik_absent), sd=sd(log_lik_absent))$value,
hit = integrate(f1, 0, Inf, mu=mean(log_lik_present),  sd=sd(log_lik_present))$value,
pc = round((hit + cr)/2,5),
pc = ifelse(pc == 0, 1/2^50, pc - 1/2^50),
dprime = 2 * qnorm(pc)
)
models <- lapply(seq(10,20,length.out =10), FUN = function(x) {models <- get_scaled_model(model.wide,x); models$SUBJECT <- x; return(models)});models <- do.call(rbind, models)
warnings()
scaled.model <- model.wide %>%
rowwise() %>%
mutate(n_obs = length(data_response_vec_0[,1]),
SUBJECT = "model",
var_scale = list((1 + scale.val) * (data_var_vec_0 + data_var_vec_1)),
data_cor_vec_0 = list(c(data_cov_vec_0 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_cor_vec_1 = list(c(data_cov_vec_1 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_var_vec_0 = list(data_var_vec_0 + var_scale),
data_var_vec_1 = list(data_var_vec_1 + var_scale),
data_sd_vec_1 = list(sqrt(data_var_vec_1)),
data_sd_vec_0 = list(sqrt(data_var_vec_0)),
data_cor_mat_0 = list(matrix(c(1, data_cor_vec_0[1], data_cor_vec_0[2],data_cor_vec_0[1],1,data_cor_vec_0[3],data_cor_vec_0[2],data_cor_vec_0[3],1),nrow = 3)),
data_cor_mat_1 = list(matrix(c(1, data_cor_vec_1[1], data_cor_vec_1[2],data_cor_vec_1[1],1,data_cor_vec_1[3],data_cor_vec_1[2],data_cor_vec_1[3],1),nrow = 3)),
data_cov_mat_0 = list(data_cor_mat_0 * (data_sd_vec_0) %*% t(data_sd_vec_0)),
data_cov_mat_1 = list(data_cor_mat_1 * (data_sd_vec_1) %*% t(data_sd_vec_1)),
data_response_vec_0 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_0, sigma = data_cov_mat_0)),
data_response_vec_1 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_1, sigma = data_cov_mat_1)),
log_lik_absent      = list((mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
log_lik_present     = list((mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
pc = (sum(log_lik_present > 0) + (sum(log_lik_absent < 0)))/(2 * 1000) - 1/1000,
cr = integrate(f1, -Inf, 0, mu=mean(log_lik_absent), sd=sd(log_lik_absent))$value,
hit = integrate(f1, 0, Inf, mu=mean(log_lik_present),  sd=sd(log_lik_present))$value,
pc = round(ifelse(pc == 0, 1/2^50, pc - 1/2^50),5),
dprime = 2 * qnorm(pc)
)
scaled.model <- model.wide %>%
rowwise() %>%
mutate(n_obs = length(data_response_vec_0[,1]),
SUBJECT = "model",
var_scale = list((1 + scale.val) * (data_var_vec_0 + data_var_vec_1)),
data_cor_vec_0 = list(c(data_cov_vec_0 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_cor_vec_1 = list(c(data_cov_vec_1 / (sqrt(data_var_vec_0 + var_scale) * sqrt(data_var_vec_1 + var_scale)))),
data_var_vec_0 = list(data_var_vec_0 + var_scale),
data_var_vec_1 = list(data_var_vec_1 + var_scale),
data_sd_vec_1 = list(sqrt(data_var_vec_1)),
data_sd_vec_0 = list(sqrt(data_var_vec_0)),
data_cor_mat_0 = list(matrix(c(1, data_cor_vec_0[1], data_cor_vec_0[2],data_cor_vec_0[1],1,data_cor_vec_0[3],data_cor_vec_0[2],data_cor_vec_0[3],1),nrow = 3)),
data_cor_mat_1 = list(matrix(c(1, data_cor_vec_1[1], data_cor_vec_1[2],data_cor_vec_1[1],1,data_cor_vec_1[3],data_cor_vec_1[2],data_cor_vec_1[3],1),nrow = 3)),
data_cov_mat_0 = list(data_cor_mat_0 * (data_sd_vec_0) %*% t(data_sd_vec_0)),
data_cov_mat_1 = list(data_cor_mat_1 * (data_sd_vec_1) %*% t(data_sd_vec_1)),
data_response_vec_0 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_0, sigma = data_cov_mat_0)),
data_response_vec_1 = list(mvtnorm::rmvnorm(1000, mean = data_mean_vec_1, sigma = data_cov_mat_1)),
log_lik_absent      = list((mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_0, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
log_lik_present     = list((mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_1, sigma = data_cov_mat_1, log = T) -
mvtnorm::dmvnorm(data_response_vec_1, mean = data_mean_vec_0, sigma = data_cov_mat_0, log = T))),
pc = (sum(log_lik_present > 0) + (sum(log_lik_absent < 0)))/(2 * 1000) - 1/1000,
cr = integrate(f1, -Inf, 0, mu=mean(log_lik_absent), sd=sd(log_lik_absent))$value,
hit = integrate(f1, 0, Inf, mu=mean(log_lik_present),  sd=sd(log_lik_present))$value,
pc = round(ifelse(pc == 0, 1/2^50, pc - 1/2^50),8),
dprime = 2 * qnorm(pc)
)
source('~/Dropbox/Calen/Work/occluding/detection_model_analysis/_model/gaussian_model.R', echo=TRUE)
models <- lapply(seq(10,20,length.out =10), FUN = function(x) {models <- get_scaled_model(model.wide,x); models$SUBJECT <- x; return(models)});models <- do.call(rbind, models)
plot_dprime_family(models)
source('~/Dropbox/Calen/Work/occluding/detection_model_analysis/_model/gaussian_model.R', echo=TRUE)
models <- lapply(seq(10,20,length.out =10), FUN = function(x) {models <- get_scaled_model(model.wide,x); models$SUBJECT <- x; return(models)});models <- do.call(rbind, models)
plot_dprime_family(models)
source('~/Dropbox/Calen/Work/occluding/detection_model_analysis/_model/gaussian_model.R', echo=TRUE)
models <- lapply(seq(2,20,length.out =10), FUN = function(x) {models <- get_scaled_model(model.wide,x); models$SUBJECT <- x; return(models)});models <- do.call(rbind, models)
X
cov(X)
sd(X[,1])
sd(X[,2])
models <- lapply(seq(2,20,length.out =10), FUN = function(x) {models <- get_scaled_model(model.wide,x); models$SUBJECT <- x; return(models)});models <- do.call(rbind, models)
models <- lapply(seq(5,20,length.out =10), FUN = function(x) {models <- get_scaled_model(model.wide,x); models$SUBJECT <- x; return(models)});models <- do.call(rbind, models)
plot_dprime_family(models)
m1 <- get_scaled_model(model.wide,5)
m1$dprime %>% head
m1$pc %>% head
mean(m1$log_lik_absent[[1]])
sd(m1$log_lik_absent[[1]])
sd(m1$log_lik_present[[1]])
mean(m1$log_lik_present[[1]])
mean(m1$log_lik_present[[2]])
mean(m1$log_lik_absent[[2]])
m1$pc %>% head
m1$hit %>% head
integer(f1, -Inf,0,-300,35)
integer(f1, -Inf,0,mu=-300,sd=35)
integrate(f1, -Inf,0,mu=-300,sd=35)
m1$hit %>% head
mean(m1$log_lik_absent)
mean(m1$log_lik_absent[[1]])
sd(m1$log_lik_absent[[1]])
integrate(f1, -Inf, 0, mu=(-518), sd=35)$value
integrate(f1, -Inf, 0, mu=(-518), sd=1)$value
integrate(f1, -Inf, 0, mu=(2), sd=1)$value
integrate(f1, -Inf, Inf, mu=(2), sd=1)$value
integrate(f1, -Inf, 0, mu=(2), sd=1)$value
integrate(f1, -Inf, 0, mu=(-2), sd=1)$value
integrate(f1, -Inf, 0, mu=(-200), sd=1)$value
integrate(f1, -Inf, 0, mu=(-20), sd=1)$value
integrate(f1, -Inf, 0, mu=(-10), sd=1)$value
integrate(f1, -Inf, 0, mu=(-10), sd=1)$value
?integrate
dnorm(-10000,-500,1)
dnorm(-1000,-500,1)
dnorm(-501,-500,1)
integrate(f1, -Inf, 0, mu=(-200), sd=1)$value
integrate(f1, -Inf, 0, mu=(-200), sd=1)
integrate(f1, -Inf, 0, mu=(-20), sd=1)
integrate(f1, -Inf, 0, mu=(-2), sd=1)
715/603
715 / (603 + 715)
